<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0017)http://localhost/ -->
<html>
<head>
<title> Populate the Airport DataSet </title>
<link rel="stylesheet" TYPE="text/css" HREF="stylesheet.css">
<meta name="Generator" content="AITPublish">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="Keywords" content="">
<link rel="stylesheet" href="stylesheet.css">
<script language="javascript" type="text/javascript" src="dhtml_toc.js"></script>
</HEAD>
<body>
<table cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "0">
<p class="bodytext"><a href="1652.html" target="_self"><img src="574.png" alt="Previous Topic" height="16px" width="16px" vspace="0" hspace="0" align="bottom" border="0"></a></p></td>
<td width= "0">
<p class="bodytext"><a href="1620.html" target="_self"><img src="573.png" alt="Next Topic" height="16px" width="16px" vspace="0" hspace="0" align="bottom" border="0"></a></p></td>
</tr>
</table>
<h5 class="heading5">Populate the Airport DataSet</h5>
<p class="bodytext">Populate the DataSet with the ingresDataAdapter3.Fill(DataSet dataSet) method.</p>
<p class="codefirst">public void LoadAirport(int direction, String area, System.Data.DataTable airportTable)</p>
<p class="codefirst">{</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;DataRow dataRow;</p>
<p class="codefirst">&nbsp;</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;IngresParameter country = new Ingres.Client.IngresParameter(</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ap_ccode&quot;, IngresType.NChar);</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;IngresParameter region = new Ingres.Client.IngresParameter(</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ap_place&quot;, IngresType.NVarChar);</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;region.Value = area;</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;airportTable.Clear();</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;dataRow = airportTable.NewRow();</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;dataRow[&quot;ap_iatacode&quot;] = &quot;&quot;;</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;airportTable.Rows.InsertAt(dataRow, 0);</p>
<p class="codefirst"></p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;ingresDataAdapter3.SelectCommand.Connection.Open();</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;ingresDataAdapter3.SelectCommand.Prepare();</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;ingresDataAdapter3.SelectCommand.Parameters.Clear();</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;switch (direction)</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;{</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case DEPART:</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;country.Value = departing.country;</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;departing.region = region.Value.ToString();</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ARRIVE:</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;country.Value = arriving.country;</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arriving.region = region.Value.ToString();</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;ingresDataAdapter3.SelectCommand.Parameters.Add(country);</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;ingresDataAdapter3.SelectCommand.Parameters.Add(region);</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;ingresDataAdapter3.Fill(airportTable);</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;ingresDataAdapter3.SelectCommand.Connection.Close();</p>
<p class="codefirst">}</p>
<p class="note"><strong class="bold">Note:</strong> Use an instance of the table defined in the AirportDataSet as a parameter to this method. For example:</p>
<p class="codefirst">AirportDataSet airportDataSet = new AirportDataSet();</p>
<p class="codefirst"></p>
<p class="codefirst">LoadAirport(direction, comboBox1.SelectedValue.ToString(),</p>
<p class="codefirst">&nbsp;&nbsp;&nbsp;&nbsp;airportDataSet.Tables[&quot;airport&quot;]);</p>


<p>
<hr>
<font size="-2" face="Verdana">
&#0169;&nbsp;<authorit:cdate>2006 Ingres Corporation.  
All rights reserved.<br> &nbsp;
</font>
</body>
</html>


